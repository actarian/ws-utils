{"version":3,"sources":["dist/js/ws-utils.js"],"names":["app","angular","module","directive","$timeout","restrict","link","scope","element","attributes","model","onTap","e","addClass","removeClass","addListeners","on","removeListeners","off","$on","animate","delays","undefined","split","delay","forEach","d","i","parseInt","length","push","removeClasses","join","indexOf","shift","a","require","type","validateType","$parsers","unshift","value","$setValidity","String","Number","toString","replace","template","form","title","placeholder","name","formKey","formFocus","required","label","key","readonly","control","match","options","number","source","canCreate","flatten","queryable","onSelected","rows","$parse","$window","MAX_ITEMS","service","getPhrase","Clear","phrase","items","count","input","val","Current","current","active","onTyping","Enter","item","onSelect","$apply","Up","Down","Parse","data","index","toLowerCase","NameA","substr","NameB","NameC","Filter","c","Search","setPhrase","then","success","error","console","log","onKeyDown","keyCode","preventDefault","onKeyUp","call","this","onUp","Utils","getClosest","target","onBlur","Init","init","find","maxItems","POSITIVE_INFINITY","onFocus","$parent","$eval","setItem","parsedItem","$item","$event","extend","$watch","newValue","$watchCollection","$compile","doTop","busy","onTop","sy","ey","setTimeout","undrag","doBottom","onBottom","lbottom2","offsetHeight","inner","lbottom","padding","dragging","wheeling","move","down","removeDragListeners","bounce","ltop","redraw","time","y","speed","Math","abs","cy","pause","min","max","innerStyle","transform","toFixed","set","showIndicatorFor","percent","iy","indicator","ix","round","html","indicatorStyle","play","loop","aKey","window","requestAnimationFrame","cancelAnimationFrame","onDown","getTouch","addDragListeners","onMove","prev","up","_onWheel","event","dir","deltaY","wheelDelta","onWheel","ondragstart","attr","Style","append","contents","throttle","src","ngImg","image","Image","onload","$set","load","WebWorker","worker","doWork","onImageLoaded","post","url","ngImgWorker","factory","Vector","x","make","b","size","sqrt","normalize","l","incidence","angle","atan2","distance","cross","difference","prototype","towards","friction","add","copy","previous","t","touch","originalEvent","touches","changedTouches","pageX","pageY","s","getRelativeTouch","point","rect","getBoundingClientRect","left","top","el","selector","matchesFn","parent","some","fn","document","body","parentElement","func","wait","context","args","result","timeout","later","leading","getNow","apply","now","remaining","arguments","clearTimeout","trailing","lastTime","vendors","callback","currTime","Date","getTime","timeToCall","id","transformProperty","safariPropertyHack","div","createElement","style","every","prefix","props","scale","hoverScale","currentScale","styles","cssText","transformOrigin","DataFilter","getSearchParams","search","p","getParams","infinite","JSON","stringify","page","$q","$http","$httpAsync","$rootScope","DataSource","maxPages","filters","resolve","uri","paging","get","deferred","pages","pagination","getPages","$broadcast","bind","flush","PAGES_MAX","opened","response","responseHeader","headers","responseView","parse","params","reject","defer","promise","refresh","more","filter","prevPage","nextPage","gotoPage","firstPage","lastPage","hasMany","hasMorePagesBehind","startingIndex","hasMorePagesNext","endingIndex","isPage","hasPages","openClose","LocalStorage","isLocalStorageSupported","isSupported","cache","json","localStorage","onStorage","self","callbacks","Worker","onmessage","isWebWorkerSupported","transformResponse","h","eval","object","o","postMessage","status","wrap","getDefaults","isSuccess","createMap","Object","create","isString","parseHeaders","fillInParsed","parsed","j","line","lowercase","trim","isObject","headersGetter","headersObj","defaults","method","withCredentials","responseType","config","common","string","head","put","patch","getter","statusText","controller","$scope","$location","DishesTest"],"mappings":"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","file":"dist/js/ws-utils.min.js","sourcesContent":["/*global angular*/\r\n\r\nvar app = angular.module('wsUtils', ['ngMessages']);\r\n\n\n/*global angular*/\r\n\r\n/**\r\n   * @ngdoc directive\r\n   * @name onTap\r\n   * @kind function\r\n   * @requires $timeout\r\n   *\r\n   * @description\r\n   * When called, it add a class named 'tapped' on element and removes it after a timeout of 500 ms\r\n   *\r\n   * @example\r\n   <example module=\"examples\">\r\n      <file name=\"index.html\">\r\n         <button type=\"button\" on-tap>Tap me!</button>\r\n      </file>\r\n      <file name=\"script.js\">\r\n         angular.module('examples', ['wsUtils']);\r\n      </file>\r\n      <file name=\"style.css\">\r\n         .tapped {\r\n            background: red;\r\n         }\r\n      </file>\r\n   </example>\r\n*/\r\napp.directive('onTap', ['$timeout', function($timeout) {\r\n   return {\r\n      restrict: 'A',\r\n      link: function(scope, element, attributes, model) {\r\n         function onTap(e) {\r\n            element.addClass('tapped');\r\n            $timeout(function() {\r\n               element.removeClass('tapped');\r\n            }, 500)\r\n         };\r\n         function addListeners() {\r\n            element.on('touchstart mousedown', onTap);\r\n         };\r\n         function removeListeners() {\r\n            element.off('touchstart mousedown', onTap);\r\n         };\r\n         scope.$on('$destroy', function() {\r\n            removeListeners();\r\n         });\r\n         addListeners();\r\n      }\r\n   }\r\n}]);\r\n\r\n/**\r\n   * @ngdoc directive\r\n   * @name animate\r\n   * @kind function\r\n   * @requires $timeout\r\n   *\r\n   * @description\r\n   * When called, it add a class named 'animated' on element\r\n   *\r\n   * @param {string} [animate=fadeIn] a comma separated animate.css class names\r\n   * @param {string} [delay=1] a comma separated durations list in milliseconds\r\n   *\r\n   * @example\r\n   <example module=\"examples\">\r\n      <file name=\"index.html\">\r\n         <div type=\"button\" animate=\"fadeInUp\" delay=\"1000\">\r\n            I'm an animated div.\r\n         </div>\r\n      </file>\r\n      <file name=\"script.js\">\r\n         angular.module('examples', ['wsUtils']);\r\n      </file>\r\n   </example>\r\n*/\r\napp.directive('animate', ['$timeout', function($timeout) {\r\n   return {\r\n      restrict: 'A',\r\n      link: function(scope, element, attributes, model) {\r\n         element.addClass('animated');\r\n         var animate = ['fadeIn'], delays = ['1'];\r\n         if (attributes.animate !== undefined) {\r\n            animate = attributes.animate.split(',');\r\n         }\r\n         if (attributes.delay !== undefined) {\r\n            delays = attributes.delay.split(',');\r\n         }\r\n         angular.forEach(delays, function(d, i) {\r\n            delays[i] = parseInt(d);\r\n         });\r\n         while (delays.length < animate.length) {\r\n            delays.push(delays[delays.length - 1] + 50);\r\n         }\r\n         var removeClasses = animate.join(' ');\r\n         if (animate[0].indexOf('In') !== -1) {\r\n            element.addClass('invisible');\r\n            removeClasses += ' invisible';\r\n         }\r\n         while (animate.length) {\r\n            var d = delays.shift();\r\n            var a = animate.shift();\r\n            $timeout(function() {\r\n               element.removeClass(removeClasses);\r\n               element.addClass(a);\r\n               if (animate.length === 0 && a.indexOf('Out') !== -1) {\r\n                  $timeout(function() {\r\n                     element.addClass('invisible');\r\n                  }, 1000);\r\n               }\r\n            }, d);\r\n         }\r\n      }\r\n   }\r\n}]);\r\n\r\n/**\r\n   * @ngdoc directive\r\n   * @name validateType\r\n   * @kind function\r\n   * @requires ngModel\r\n   *\r\n   * @description\r\n   * Custom validation type for ngModel\r\n   *\r\n   * @param {string} [validateType=number] the type of custom validation\r\n   *\r\n   * @example\r\n\t<example module=\"examples\">\r\n\t\t<file name=\"index.html\">\r\n\t\t\t<form name=\"myForm\">\r\n\t\t\t\t<input name=\"myValue\" type=\"text\" ng-model=\"model\" validate-type=\"number\" />\r\n\t\t\t\t<span ng-messages=\"(myForm.$submitted || myForm.$touched) && myForm.myValue.$error\" role=\"alert\">\r\n\t\t\t\t\t<span ng-message=\"number\" class=\"label-error animated flash\"> &larr; enter a valid number</span>\r\n\t\t\t\t</span>\r\n\t\t\t</form>\r\n\t\t</file>\r\n\t\t<file name=\"script.js\">\r\n\t\t\tangular.module('examples', ['wsUtils']);\r\n\t\t</file>\r\n\t</example>\r\n*/\r\napp.directive('validateType', function() {\r\n   return {\r\n      require: 'ngModel',\r\n      link: function(scope, element, attributes, model) {\r\n         var type = attributes.validateType;\r\n         switch (type) {\r\n            case 'number':\r\n               model.$parsers.unshift(function(value) {\r\n                  model.$setValidity(type, String(value).indexOf(Number(value).toString()) !== -1);\r\n                  return value;\r\n               });\r\n               break;\r\n         }\r\n      }\r\n   };\r\n});\r\n\r\n/**\r\n   * @ngdoc directive\r\n   * @name control\r\n   * @kind function\r\n   *\r\n   * @description\r\n   * Dinamic form control generator through templates with extended validation\r\n   *\r\n   * @param {string} model the target model of control\r\n   * @param {string} [control=text] the type of control, available types (text, password, email, number, checkbox, textarea, datetime-local, select, autocomplete)\r\n   * @param {string} [form=Form] the name of the form\r\n   * @param {string} [title=Untitled] the title of the control\r\n   * @param {string} [placeholder=title] the placeholder of the control\r\n   * @param {string} [source=null] datasource of select as array\r\n   * @param {string} [key=id] optional key for select option\r\n   * @param {string} [label=name] optional label for select option\r\n   * @param {string} [required=false] if the control is required\r\n   *\r\n   * @example\r\n   <example module=\"examples\">\r\n      <file name=\"index.html\">\r\n         <div class=\"container-fluid\">\r\n            <div class=\"row\">\r\n               <form name=\"myForm\">\r\n                  <div class=\"form-group col-xs-12\" form=\"myForm\" control=\"select\" title=\"category\" placeholder=\"select a category\" model=\"model.category\" source=\"[{name:'Main',id:1}, {name:'Second',id:2}]\" required=\"true\"></div>\r\n                  <div class=\"form-group col-xs-12\" form=\"myForm\" control=\"number\" title=\"dish price\" placeholder=\"type the price of the dish\" model=\"model.dish.price\" required=\"true\"></div>\r\n                  <div class=\"form-group col-xs-12\" form=\"myForm\" control=\"checkbox\" title=\"is vegan friendly\" placeholder=\"please check if the dish is vegan friendly\" model=\"model.dish.isVeganFriendly\"></div>\r\n               </form>\r\n            </div>\r\n         </div>\r\n      </file>\r\n      <file name=\"script.js\">\r\n         angular.module('examples', ['wsUtils']);\r\n      </file>\r\n   </example>\r\n*/\r\napp.directive('control', [function() {\r\n   return {\r\n      restrict: 'A',\r\n      replace: true,\r\n      template: function(element, attributes) {\r\n         var form = attributes.form || 'Form';\r\n         var title = attributes.title || 'Untitled';\r\n         var placeholder = attributes.placeholder || title;\r\n         var name = title.replace(/[^0-9a-zA-Z]/g, \"\").split(' ').join('');\r\n         var formKey = form + '.' + name;\r\n         var formFocus = ' ng-focus=\"' + formKey + '.hasFocus=true\" ng-blur=\"' + formKey + '.hasFocus=false\"';\r\n         var required = '';\r\n         var label = (attributes.label ? attributes.label : 'name');\r\n         var key = (attributes.key ? attributes.key : 'id');\r\n         var model = attributes.model;\r\n         if (attributes.required) {\r\n            required = '<span ng-messages=\"' + (attributes.readonly ? '' : '(' + form + '.$submitted || ' + formKey + '.$touched) && ') + form + '.' + name + '.$error\" role=\"alert\"><span ng-message=\"required\" class=\"label-error animated flash\"> &larr; required</span>';\r\n            switch (attributes.control) {\r\n               case 'password':\r\n                  required = required + '<span ng-message=\"minlength\" class=\"label-error animated flash\"> &larr; at least 6 chars</span>';\r\n                  break;\r\n               case 'email':\r\n                  required = required + '<span ng-message=\"email\" class=\"label-error animated flash\"> &larr; incorrect</span>';\r\n                  break;\r\n               case 'number':\r\n                  required = required + '<span ng-message=\"number\" class=\"label-error animated flash\"> &larr; enter a valid number</span>';\r\n                  break;\r\n            }\r\n            if (attributes.match !== undefined) {\r\n               required = required + '<span ng-message=\"match\" class=\"label-error animated flash\"> &larr; not matching</span>';\r\n            }\r\n            required = required + '</span>';\r\n         } else {\r\n            required = ' (optional)';\r\n         }\r\n         var template = '<div ' + (attributes.readonly ? ' class=\"readonly\" ' : '') + ' ng-class=\"{ focus: ' + formKey + '.hasFocus, success: ' + formKey + '.$valid, error: ' + formKey + '.$invalid && (form.$submitted || ' + formKey + '.$touched), empty: !' + formKey + '.$viewValue }\"><label for=\"' + name + '\" class=\"control-label\">' + title + required + '</label>';\r\n         switch (attributes.control) {\r\n            case 'checkbox':\r\n               template = '<div class=\"checkbox\">';\r\n               template += '<span class=\"checkbox-label\">' + title + required + '</span>';\r\n               template += '<span class=\"switch\"><input id=\"' + name + '\" name=\"' + name + '\" type=\"checkbox\" ng-model=\"' + model + '\" ' + (attributes.required ? 'required=\"true\"' : '') + ' class=\"toggle toggle-round-flat\"><label for=\"' + name + '\"></label></span>';\r\n               template += '</div>';\r\n               break;\r\n            case 'select':\r\n               var options = attributes.number\r\n                  ? 'item.' + key + ' as item.' + label + ' for item in ' + attributes.source\r\n                  : 'item.' + label + ' for item in ' + attributes.source + ' track by item.' + key;\r\n               template += '<select name=\"' + name + '\" class=\"form-control\" ng-model=\"' + model + '\" ng-options=\"' + options + '\" ' + (attributes.number ? 'convert-to-number' : '') + ' ' + (attributes.required ? 'required=\"true\"' : '') + '><option value=\"\" disabled selected hidden>' + placeholder + '</option></select>';\r\n               break;\r\n            case 'autocomplete':\r\n               var canCreate = (attributes.canCreate ? attributes.canCreate : false);\r\n               var flatten = (attributes.flatten ? attributes.flatten : false);\r\n               var queryable = (attributes.queryable ? attributes.queryable : false);\r\n               var onSelected = (attributes.onSelected ? ' on-selected=\"' + attributes.onSelected + '\"' : '');\r\n               template += '<input name=\"' + name + '\" ng-model=\"' + model + '\" type=\"hidden\" ' + (attributes.required ? 'required' : '') + '>';\r\n               template += '<div control-autocomplete=\"' + attributes.source + '\" model=\"' + model + '\" label=\"' + label + '\"  key=\"' + key + '\" can-create=\"' + canCreate + '\" flatten=\"' + flatten + '\" queryable=\"' + queryable + '\" placeholder=\"' + placeholder + '\" on-focus=\"' + formKey + '.hasFocus=true\" on-blur=\"' + formKey + '.hasFocus=false\"' + onSelected + '></div>';\r\n               break;\r\n            case 'textarea':\r\n               template += '<textarea name=\"' + name + '\" class=\"form-control\" ng-model=\"' + model + '\"' + (attributes.options ? ' ng-model-options=\"' + attributes.options + '\" ' : '') + ' placeholder=\"' + placeholder + '\" ' + (attributes.required ? 'required' : '') + ' rows=\"' + (attributes.rows ? attributes.rows : '1') + '\"' + formFocus + '></textarea>';\r\n               break;\r\n            case 'datetime-local':\r\n               placeholder == title ? placeholder = 'yyyy-MM-ddTHH:mm:ss' : null;\r\n               template += '<input name=\"' + name + '\" class=\"form-control\" ng-model=\"' + model + '\"' + (attributes.options ? ' ng-model-options=\"' + attributes.options + '\" ' : '') + ' placeholder=\"' + placeholder + '\" type=\"datetime-local\"' + (attributes.required ? ' required' : '') + (attributes.readonly ? ' readonly' : '') + formFocus + '>';\r\n               break;\r\n            case 'password':\r\n               template += '<input name=\"' + name + '\" class=\"form-control\" ng-model=\"' + model + '\"' + (attributes.options ? ' ng-model-options=\"' + attributes.options + '\" ' : '') + ' placeholder=\"' + placeholder + '\" type=\"password\" ng-minlength=\"6\" ' + (attributes.required ? 'required' : '') + formFocus + '>';\r\n               break;\r\n            case 'email':\r\n               template += '<input name=\"' + name + '\" class=\"form-control\" ng-model=\"' + model + '\"' + (attributes.options ? ' ng-model-options=\"' + attributes.options + '\" ' : '') + ' placeholder=\"' + placeholder + '\" type=\"email\" ' + (attributes.required ? 'required' : '') + formFocus + '>';\r\n               break;\r\n            case 'number':\r\n               template += '<input name=\"' + name + '\" class=\"form-control\" ng-model=\"' + model + '\"' + (attributes.options ? ' ng-model-options=\"' + attributes.options + '\" ' : '') + ' placeholder=\"' + placeholder + '\" type=\"text\"' + (attributes.required ? ' required' : '') + (attributes.readonly ? ' readonly' : '') + formFocus + ' validate-type=\"number\">'; // ' validator=\"{ number: isNumber }\">';\r\n               break;\r\n            case 'text':\r\n            default:\r\n               template += '<input name=\"' + name + '\" class=\"form-control\" ng-model=\"' + model + '\"' + (attributes.options ? ' ng-model-options=\"' + attributes.options + '\" ' : '') + ' placeholder=\"' + placeholder + '\" type=\"text\"' + (attributes.required ? ' required' : '') + (attributes.readonly ? ' readonly' : '') + formFocus + '>';\r\n               break;\r\n         }\r\n         return template + '</div>';\r\n      },\r\n      link: function(scope, element, attributes, model) {\r\n      },\r\n   };\r\n}]);\r\n\r\n/**\r\n   * @ngdoc directive\r\n   * @name controlAutocomplete\r\n   * @kind function\r\n   * @requires ngModel\r\n   *\r\n   * @description\r\n   * Custom control type with autocomplete functionality. (use the shortcut version with control directive)\r\n   *\r\n   * @param {service} controlAutocomplete the datasource service\r\n   * @param {model} model the target model of control\r\n   * @param {boolean} [canCreate=false] setted on true the control can add new entities\r\n   * @param {boolean} [flatten=false] set to true to flat the value to the model\r\n   * @param {boolean} [queryable=false] set to true if is a queryable service\r\n   * @param {string} [key=id] optional key for select option\r\n   * @param {string} [label=name] optional label for select option\r\n   *\r\n   * @example\r\n   <example module=\"examples\">\r\n      <file name=\"index.html\">\r\n         <div class=\"container-fluid\">\r\n            <div class=\"row\">\r\n               <form name=\"myForm\">\r\n                  <div class=\"form-group col-xs-12 empty focus\">\r\n                     <label for=\"dishname\" class=\"control-label\">dish name<span ng-messages=\"(myForm.$submitted || myForm.dishname.$touched) &amp;&amp; myForm.dishname.$error\" role=\"alert\" class=\"ng-inactive\"></span></label>\r\n                     <input name=\"dishname\" ng-model=\"model.name\" type=\"hidden\" required=\"\">\r\n                     <div control-autocomplete=\"dishesAutocomplete\" model=\"model.name\" label=\"name\" key=\"name\" can-create=\"true\" flatten=\"true\" queryable=\"false\" placeholder=\"type the name of the dish\" on-focus=\"myForm.dishname.hasFocus=true\" on-blur=\"myForm.dishname.hasFocus=false\" on-selected=\"onDishSelected($item)\" class=\"ng-isolate-scope\"></div>\r\n               </form>\r\n            </div>\r\n         </div>\r\n      </file>\r\n      <file name=\"script.js\">\r\n         angular.module('examples', ['wsUtils']);\r\n         angular.run(['$rootScope', '$q', function($rootScope, $q) {\r\n            $rootScope.dishesAutocomplete = ;\r\n            $rootScope.onDishSelected = function($item) {\r\n               alert($item);\r\n            };\r\n         }]);\r\n      </file>\r\n   </example>\r\n*/\r\napp.directive('controlAutocomplete', ['$parse', '$window', '$timeout', function($parse, $window, $timeout) {\r\n   var MAX_ITEMS = 5;\r\n   return {\r\n      restrict: 'A',\r\n      scope: {\r\n         service: '=controlAutocomplete',\r\n         canCreate: '=',\r\n         flatten: '=',\r\n         queryable: '=',\r\n         model: '=',\r\n         label: '@',\r\n         key: '@',\r\n      },\r\n      template: function(element, attributes) {\r\n         var template = '<div>';\r\n         template += '   <input class=\"form-control\" ng-model=\"phrase\" ng-model-options=\"{ debounce: 150 }\" placeholder=\"' + attributes.placeholder + '\" type=\"text\" ng-focus=\"onFocus()\">';\r\n         template += '   <ul class=\"form-autocomplete\" ng-show=\"items.length\">';\r\n         template += '       <li ng-repeat=\"item in items\" ng-class=\"{ active: active == $index }\" ng-click=\"onSelect(item)\">';\r\n         template += '           <span>{{item.NameA}}<span class=\"token\">{{item.NameB}}</span>{{item.NameC}}</span>';\r\n         template += '       </li>';\r\n         template += '   </ul>';\r\n         template += '</div>';\r\n         return template;\r\n      },\r\n      link: function(scope, element, attributes, model) {\r\n         var onSelected = $parse(attributes.onSelected);\r\n         var input = element.find('input');\r\n         var label = (scope.label ? scope.label : 'name');\r\n         var key = (scope.key ? scope.key : 'id');\r\n         function getPhrase() {\r\n            if (scope.model) {\r\n               return scope.flatten ? scope.model : scope.model[label];\r\n            } else {\r\n               return null;\r\n            }\r\n         }\r\n         scope.phrase = getPhrase();\r\n         scope.count = 0;\r\n         scope.items = [];\r\n         scope.active = -1;\r\n         scope.maxItems = scope.maxItems || Number.POSITIVE_INFINITY;\r\n         function Clear(phrase) {\r\n            scope.items.length = 0;\r\n            scope.count = 0;\r\n            scope.phrase = phrase || null;\r\n            input.val(scope.phrase);\r\n         }\r\n         function Current() {\r\n            var current = null;\r\n            if (scope.active != -1 && scope.items.length > scope.active) {\r\n               current = scope.items[scope.active];\r\n            }\r\n            return current;\r\n         }\r\n         scope.onFocus = function() {\r\n            if (attributes.onFocus !== undefined) {\r\n               scope.$parent.$eval(attributes.onFocus);\r\n            }\r\n            if (input.val() === getPhrase()) {\r\n               input.val(null);\r\n            }\r\n         };\r\n         scope.onBlur = function() {\r\n            if (attributes.onBlur !== undefined) {\r\n               scope.$parent.$eval(attributes.onBlur);\r\n            }\r\n            Clear(getPhrase());\r\n         };\r\n         scope.onSelect = function(item) {\r\n            if (scope.queryable) {\r\n               scope.service.setItem(item).then(function(parsedItem) {\r\n                  onSelected({ $item: parsedItem }, scope.$parent, { $event: {} });\r\n                  $timeout(function() {\r\n                     if (scope.flatten) {\r\n                        scope.model = parsedItem[key];\r\n                     } else {\r\n                        scope.model = scope.model || {};\r\n                        angular.extend(scope.model, parsedItem);\r\n                     }\r\n                     scope.onBlur();\r\n                  }, 1);\r\n               });\r\n            } else {\r\n               onSelected({ $item: item }, scope.$parent, { $event: {} });\r\n               if (scope.flatten) {\r\n                  scope.model = item[key];\r\n               } else {\r\n                  scope.model = scope.model || {};\r\n                  angular.extend(scope.model, item);\r\n               }\r\n               scope.onBlur();\r\n            }\r\n         };\r\n         function onTyping(phrase) {\r\n            if (scope.canCreate) {\r\n               if (scope.flatten) {\r\n                  if (key === label) {\r\n                     scope.model = phrase;\r\n                  }\r\n               } else {\r\n                  scope.model = {};\r\n                  scope.model[label] = phrase;\r\n               }\r\n            }\r\n         };\r\n         function Enter() {\r\n            var item = Current();\r\n            if (item) {\r\n               scope.onSelect(item);\r\n            }\r\n            scope.$apply();\r\n         }\r\n         function Up() {\r\n            scope.active--;\r\n            if (scope.active < 0) {\r\n               scope.active = scope.items.length - 1;\r\n            }\r\n            scope.$apply();\r\n         }\r\n         function Down() {\r\n            scope.active++;\r\n            if (scope.items.length == 0) {\r\n               scope.active = -1;\r\n            } else if (scope.active >= scope.items.length) {\r\n               scope.active = 0;\r\n            }\r\n            scope.$apply();\r\n         }\r\n         function Parse(data) {\r\n            scope.items = data.items;\r\n            scope.count = data.count;\r\n            angular.forEach(scope.items, function(value, index) {\r\n               var name = value[label];\r\n               var i = name.toLowerCase().indexOf(scope.phrase.toLowerCase());\r\n               value.NameA = name.substr(0, i);\r\n               value.NameB = name.substr(i, scope.phrase.length);\r\n               value.NameC = name.substr(i + scope.phrase.length, name.length - (i + scope.phrase.length));\r\n            });\r\n         }\r\n         function Filter(data) {\r\n            var c = 0, i = [];\r\n            if (scope.phrase.length > 1) {\r\n               angular.forEach(data.items, function(value, index) {\r\n                  var name = value[label];\r\n                  if (name.toLowerCase().indexOf(scope.phrase.toLowerCase()) !== -1) {\r\n                     if (i.length < MAX_ITEMS) {\r\n                        i.push(value);\r\n                     }\r\n                     c++;\r\n                  }\r\n               });\r\n            }\r\n            Parse({\r\n               count: c,\r\n               items: i\r\n            });\r\n         }\r\n         function Search() {\r\n            scope.phrase = input.val();\r\n            scope.active = -1;\r\n            onTyping(scope.phrase);\r\n            if (scope.queryable) {\r\n               scope.service.setPhrase(scope.phrase).then(function(success) {\r\n                  scope.items = success.items;\r\n                  scope.count = success.count;\r\n               }, function(error) {\r\n                  console.log('Search.queryable.error', scope.phrase, error);\r\n               }).finally(function() {\r\n\r\n               });\r\n            } else {\r\n               Filter({\r\n                  count: scope.service.length,\r\n                  items: scope.service\r\n               });\r\n               scope.$apply();\r\n            }\r\n         }\r\n         function onKeyDown(e) {\r\n            switch (e.keyCode) {\r\n               case 9: // Tab\r\n               case 13: // Enter\r\n                  Enter();\r\n                  if (scope.items.length) {\r\n                     e.preventDefault ? e.preventDefault() : null;\r\n                     return false;\r\n                  }\r\n                  break;\r\n               case 38: // Up\r\n                  Up();\r\n                  break;\r\n               case 40: // Down\r\n                  Down();\r\n                  break;\r\n            }\r\n         }\r\n         function onKeyUp(e) {\r\n            switch (e.keyCode) {\r\n               case 9: // Tab\r\n               case 13: // Enter\r\n                  break;\r\n               case 39: // Right\r\n                  break;\r\n               case 37: // Left\r\n                  break;\r\n               case 38: // Up\r\n                  break;\r\n               case 40: // Down\r\n                  break;\r\n               default: // Text\r\n                  Search.call(this);\r\n                  break;\r\n            }\r\n         }\r\n         function onUp(e) {\r\n            if (Utils.getClosest(e.target, '[control-autocomplete]') === null) {\r\n               scope.$apply(function() {\r\n                  scope.onBlur();\r\n               });\r\n            }\r\n            return true;\r\n         }\r\n         function addListeners() {\r\n            input.on('keydown', onKeyDown);\r\n            input.on('keyup', onKeyUp);\r\n            angular.element($window).on('mouseup touchend', onUp);\r\n         };\r\n         function removeListeners() {\r\n            input.off('keydown', onKeyDown);\r\n            input.off('keyup', onKeyUp);\r\n            angular.element($window).off('mouseup touchend', onUp);\r\n         };\r\n         scope.$on('$destroy', function() {\r\n            removeListeners();\r\n         });\r\n         var init = false;\r\n         function Init() {\r\n            if (!init) {\r\n               addListeners();\r\n               init = true;\r\n            }\r\n         }\r\n         scope.$watch('service', function(newValue) {\r\n            if (newValue && (newValue.length || scope.queryable)) {\r\n               Init();\r\n            }\r\n         });\r\n         scope.$watchCollection('model', function(newValue) {\r\n            if (newValue) {\r\n               if (scope.flatten && label === key) {\r\n                  scope.phrase = newValue;\r\n                  input.val(scope.phrase);\r\n               } else if (newValue[label]) {\r\n                  scope.phrase = newValue[label];\r\n                  input.val(scope.phrase);\r\n               }\r\n            }\r\n         });\r\n      },\r\n   };\r\n}]);\r\n\r\n/**\r\n   * @ngdoc directive\r\n   * @name scrollable\r\n   * @kind function\r\n   *\r\n   * @description\r\n   * Scrollable div 3d accellerated with touch functionality and callbacks for infinite scroll\r\n   *\r\n   * @param {promise} [on-top] optional callback function that execute when reaching top\r\n   * @param {promise} [on-bottom] optional callback function that execute when reaching bottom\r\n   *\r\n   * @example\r\n   <example module=\"examples\">\r\n      <file name=\"index.html\">\r\n         <section class=\"scrollable content\" scrollable on-top=\"doRefresh()\">\r\n            <div class=\"inner\">\r\n               <ul>\r\n                  <li ng-repeat=\"item in [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20]\">item <span ng-bind=\"item\"></span></li>\r\n               </ul>\r\n            </div>\r\n         </section>\r\n      </file>\r\n      <file name=\"script.js\">\r\n         angular.module('examples', ['wsUtils']);\r\n         angular.run(['$rootScope', '$q', function($rootScope, $q) {\r\n            $rootScope.doRefresh = function() {\r\n               var deferred = $q.defer();\r\n               if ($rootScope.busy) {\r\n                  deferred.reject();\r\n               } else {\r\n                  $rootScope.busy = true;\r\n                  $timeout(function() {\r\n                     $rootScope.busy = false;\r\n                     deferred.resolve();\r\n                  }, 500);\r\n               }\r\n               return deferred.promise;\r\n            };\r\n         }]);\r\n      </file>\r\n      <file name=\"style.css\">\r\n         .scrollable.content {\r\n            height: 200px!important;\r\n         }\r\n      </file>\r\n   </example>\r\n*/\r\napp.directive('scrollable', ['$parse', '$compile', '$window', '$timeout', 'Utils', function($parse, $compile, $window, $timeout, Utils) {\r\n   return {\r\n      restrict: 'A',\r\n      link: function(scope, element, attributes, model) {\r\n         $window.ondragstart = function() { return false; };\r\n         // CONSTS;\r\n         var padding = 150;\r\n         // FLAGS;\r\n         var dragging, wheeling, busy;\r\n         // MOUSE;\r\n         var down, move, prev, up;\r\n         // COORDS;\r\n         var sy = 0, ey = 0, cy = 0, ltop = 0, lbottom = 0, speed = 0, ix = 45, iy = 0;\r\n         // ANIMATION KEY;\r\n         var aKey;\r\n         var onTop, onBottom, showIndicatorFor;\r\n         if (attributes.onTop !== undefined) {\r\n            onTop = $parse(attributes.onTop, /* interceptorFn */ null, /* expensiveChecks */ true);\r\n         }\r\n         if (attributes.onBottom !== undefined) {\r\n            onBottom = $parse(attributes.onBottom, /* interceptorFn */ null, /* expensiveChecks */ true);\r\n         }\r\n         if (attributes.showIndicatorFor !== undefined) {\r\n            showIndicatorFor = scope.$eval(attributes.showIndicatorFor); // $parse(attributes.showIndicatorFor, /* interceptorFn */ null, /* expensiveChecks */ true);\r\n         }\r\n         // console.log('showIndicatorFor', showIndicatorFor);\r\n         // ELEMENTS & STYLESHEETS;\r\n         element.attr('unselectable', 'on').addClass('unselectable');\r\n         var inner = element.find('div');\r\n         var innerStyle = new Utils.Style();\r\n         var indicator = null, indicatorStyle;\r\n         if (showIndicatorFor) {\r\n            indicator = angular.element('<div class=\"indicator\"></div>');\r\n            indicatorStyle = new Utils.Style();\r\n            element.append(indicator);\r\n            $compile(indicator.contents())(scope);\r\n            indicatorStyle.transform('translate3d(' + ix.toFixed(2) + 'px,' + iy.toFixed(2) + 'px,0)');\r\n            indicatorStyle.set(indicator[0]);\r\n         }\r\n         function doTop() {\r\n            if (busy) {\r\n               return;\r\n            }\r\n            if (!onTop) {\r\n               return;\r\n            }\r\n            busy = true;\r\n            scope.$apply(onTop).then().finally(function() {\r\n               sy = ey = 0;\r\n               setTimeout(function() {\r\n                  undrag();\r\n                  busy = false;\r\n               }, 500);\r\n            });\r\n         }\r\n         function doBottom() {\r\n            if (busy) {\r\n               return;\r\n            }\r\n            if (!onBottom) {\r\n               return;\r\n            }\r\n            busy = true;\r\n            scope.$apply(onBottom).then().finally(function() {\r\n               var lbottom2 = element[0].offsetHeight - inner[0].offsetHeight;\r\n               if (lbottom2 > lbottom) {\r\n                  sy = ey = lbottom;\r\n               } else {\r\n                  sy = ey = lbottom + padding;\r\n               }\r\n               setTimeout(function() {\r\n                  undrag();\r\n                  busy = false;\r\n               }, 500);\r\n            });\r\n         }\r\n         function undrag() {\r\n            // console.log('undrag');\r\n            dragging = false;\r\n            wheeling = false;\r\n            move = null;\r\n            down = null;\r\n            removeDragListeners();\r\n         }\r\n         function bounce() {\r\n            ltop += padding;\r\n            lbottom -= padding;\r\n            if (ey > ltop) {\r\n               doTop();\r\n            } else if (ey < lbottom) {\r\n               doBottom();\r\n            }\r\n         }\r\n         function redraw(time) {\r\n            // if (!busy) {\r\n            ltop = 0;\r\n            lbottom = element[0].offsetHeight - inner[0].offsetHeight;\r\n            if (dragging) {\r\n               ey = sy + move.y - down.y;\r\n               bounce();\r\n            } else if (speed) {\r\n               ey += speed;\r\n               speed *= .75;\r\n               if (wheeling) {\r\n                  bounce();\r\n               }\r\n               if (Math.abs(speed) < 0.05) {\r\n                  speed = 0;\r\n                  ey = sy = cy;\r\n                  wheeling = false;\r\n                  pause();\r\n               }\r\n            }\r\n            // }\r\n            ey = Math.min(ltop, ey);\r\n            ey = Math.max(lbottom, ey);\r\n            cy += (ey - cy) / 4;\r\n            innerStyle.transform('translate3d(0,' + cy.toFixed(2) + 'px,0)');\r\n            innerStyle.set(inner[0]);\r\n            if (showIndicatorFor) {\r\n               if (dragging || wheeling || speed) {\r\n                  var percent = cy / (element[0].offsetHeight - inner[0].offsetHeight);\r\n                  percent = Math.max(0, Math.min(1, percent));\r\n                  iy = (element[0].offsetHeight - indicator[0].offsetHeight) * (percent);\r\n                  ix += (0 - ix) / 4;\r\n                  // var count = Math.round(inner[0].offsetHeight / 315);\r\n                  var i = Math.max(1, Math.round(percent * showIndicatorFor.rows.length));\r\n                  indicator.html(i + '/' + showIndicatorFor.count);\r\n                  // indicator.html((percent * 100).toFixed(2).toString());\r\n               } else {\r\n                  ix += (45 - ix) / 4;\r\n               }\r\n               indicatorStyle.transform('translate3d(' + ix.toFixed(2) + 'px,' + iy.toFixed(2) + 'px,0)');\r\n               indicatorStyle.set(indicator[0]);\r\n            }\r\n         }\r\n         function play() {\r\n            function loop(time) {\r\n               redraw(time);\r\n               aKey = window.requestAnimationFrame(loop, element);\r\n            }\r\n            if (!aKey) {\r\n               loop();\r\n            }\r\n         }\r\n         function pause() {\r\n            if (aKey) {\r\n               window.cancelAnimationFrame(aKey);\r\n               aKey = null;\r\n               // console.log('Animation.paused');\r\n            }\r\n         }\r\n         function onDown(e) {\r\n            if (!busy) {\r\n               sy = ey = cy;\r\n               speed = 0;\r\n               down = Utils.getTouch(e);\r\n               wheeling = false;\r\n               // console.log(down);\r\n               addDragListeners();\r\n               play();\r\n            }\r\n         }\r\n         function onMove(e) {\r\n            prev = move;\r\n            move = Utils.getTouch(e);\r\n            dragging = true;\r\n            // console.log(move);\r\n         }\r\n         function onUp(e) {\r\n            if (move && prev) {\r\n               speed += (move.y - prev.y) * 4;\r\n            }\r\n            sy = ey = cy;\r\n            dragging = false;\r\n            move = null;\r\n            down = null;\r\n            prev = null;\r\n            up = Utils.getTouch(e);\r\n            // console.log(up);\r\n            removeDragListeners();\r\n         }\r\n         function _onWheel(e) {\r\n            if (!busy) {\r\n               if (!e) e = event;\r\n               var dir = (((e.deltaY < 0 || e.wheelDelta > 0) || e.deltaY < 0) ? 1 : -1)\r\n               /*\r\n               var evt = window.event || e;\r\n               var delta = evt.detail ? evt.detail * -120 : evt.wheelDelta\r\n               speed += delta;\r\n               */\r\n               speed += dir * 5;\r\n               wheeling = true;\r\n               play();\r\n            }\r\n         }\r\n         var onWheel = Utils.throttle(_onWheel, 25);\r\n         function addListeners() {\r\n            element.on('touchstart mousedown', onDown);\r\n            element.on('wheel', onWheel);\r\n            // element.addEventListener('DOMMouseScroll',handleScroll,false); // for Firefox\r\n            // element.addEventListener('mousewheel',    handleScroll,false); // for everyone else\r\n         };\r\n         function removeListeners() {\r\n            element.off('touchstart mousedown', onDown);\r\n            element.off('wheel', onWheel);\r\n         };\r\n         function addDragListeners() {\r\n            angular.element($window).on('touchmove mousemove', onMove);\r\n            angular.element($window).on('touchend mouseup', onUp);\r\n         };\r\n         function removeDragListeners() {\r\n            angular.element($window).off('touchmove mousemove', onMove);\r\n            angular.element($window).off('touchend mouseup', onUp);\r\n         };\r\n         scope.$on('$destroy', function() {\r\n            removeListeners();\r\n         });\r\n         addListeners();\r\n      },\r\n   };\r\n}]);\r\n\r\n/**\r\n   * @ngdoc directive\r\n   * @name ngImg\r\n   * @kind function\r\n   *\r\n   * @description\r\n   * Whenever the image has loaded, a loaded class will be added to the image element\r\n   *\r\n   * @param {string} ng-img path to the image to load\r\n   *\r\n   * @example\r\n   <example module=\"examples\">\r\n      <file name=\"index.html\">\r\n         <img src=\"\" ng-img=\"'/img/nature-01.jpg'\"/>\r\n      </file>\r\n      <file name=\"script.js\">\r\n         angular.module('examples', ['wsUtils']);\r\n      </file>\r\n      <file name=\"style.css\">\r\n         [ng-img] {\r\n            max-width: 100%;\r\n            opacity: 0;\r\n            transition: opacity ease-in-out 250ms;\r\n         }\r\n         [ng-img].loaded {\r\n            opacity: 1;\r\n         }\r\n      </file>\r\n   </example>\r\n*/\r\napp.directive('ngImg', ['$parse', '$timeout', function($parse, $timeout) {\r\n   return {\r\n      restrict: 'A',\r\n      link: function(scope, element, attributes, model) {\r\n         var src = $parse(attributes.ngImg, /* interceptorFn */ null, /* expensiveChecks */ true);\r\n         var image = new Image();\r\n         image.onload = function() {\r\n            attributes.$set('src', this.src);\r\n            setTimeout(function() {\r\n               element.addClass('loaded');\r\n            }, 10);\r\n         }\r\n         image.load = function(src) {\r\n            element.removeClass('loaded');\r\n            this.src = src;\r\n         }\r\n         scope.$watch(src, function(newValue) {\r\n            if (!newValue) {\r\n               attributes.$set('src', null);\r\n            } else {\r\n               image.load(newValue);\r\n            }\r\n         });\r\n      }\r\n   };\r\n}]);\r\n\r\n/**\r\n   * @ngdoc directive\r\n   * @name ngImgWorker\r\n   * @kind function\r\n   *\r\n   * @description\r\n   * As ngImg but using webworker. Whenever the image has loaded, a loaded class will be added to the image element\r\n   *\r\n   * @param {string} ng-img path to the image to load\r\n   *\r\n   * @example\r\n\t<example module=\"examples\">\r\n      <file name=\"index.html\">\r\n         <img src=\"\" ng-img-worker=\"'/img/nature-02.jpg'\"/>\r\n      </file>\r\n      <file name=\"script.js\">\r\n         angular.module('examples', ['wsUtils']);\r\n      </file>\r\n      <file name=\"style.css\">\r\n         [ng-img] {\r\n            max-width: 100%;\r\n            opacity: 0;\r\n            transition: opacity ease-in-out 250ms;\r\n         }\r\n         [ng-img].loaded {\r\n            opacity: 1;\r\n         }\r\n      </file>\r\n\t</example>\r\n*/\r\napp.directive('ngImgWorker', ['$parse', 'WebWorker', function($parse, WebWorker) {\r\n   var worker = new WebWorker('/js/ws-utils/workers/loader.js');\r\n   return {\r\n      restrict: 'A',\r\n      link: function(scope, element, attributes, model) {\r\n         function doWork(src) {\r\n            element.removeClass('loaded');\r\n            function onImageLoaded(src) {\r\n               attributes.$set('src', src);\r\n               setTimeout(function() {\r\n                  element.addClass('loaded');\r\n               }, 100);\r\n            }\r\n            worker.post({ url: src }).then(function(data) {\r\n               onImageLoaded(data.url);\r\n            }, function(error) {\r\n               onImageLoaded(null);\r\n            });\r\n         }\r\n         var src = scope.$eval(attributes.ngImgWorker);\r\n         if (!src) {\r\n            attributes.$set('src', null);\r\n         } else {\r\n            doWork(src);\r\n         }\r\n      }\r\n   };\r\n}]);\r\n\n/*global angular*/\r\n\r\napp.factory('Vector', function() {\r\n\tfunction Vector(x, y) {\r\n        this.x = x || 0;\r\n        this.y = y || 0;\r\n    }\r\n    Vector.make = function (a, b) {\r\n        return new Vector(b.x - a.x, b.y - a.y);\r\n    };\r\n    Vector.size = function (a) {\r\n        return Math.sqrt(a.x * a.x + a.y * a.y);\r\n    };\r\n    Vector.normalize = function (a) {\r\n        var l = Vector.size(a);\r\n        a.x /= l;\r\n        a.y /= l;\r\n        return a;\r\n    };\r\n    Vector.incidence = function (a, b) {\r\n        var angle = Math.atan2(b.y, b.x) - Math.atan2(a.y, a.x);\r\n        // if (angle < 0) angle += 2 * Math.PI;\r\n        // angle = Math.min(angle, (Math.PI * 2 - angle));\r\n        return angle;\r\n    };\r\n    Vector.distance = function (a, b) {\r\n        return Math.sqrt((a.x - b.x) * (a.x - b.x) + (a.y - b.y) * (a.y - b.y));\r\n    };\r\n    Vector.cross = function (a, b) {\r\n        return (a.x * b.y) - (a.y * b.x);\r\n    };\r\n    Vector.difference = function (a, b) {\r\n        return new Vector(b.x - a.x, b.y - a.y);\r\n    };\r\n    Vector.prototype = {\r\n        size: function () {\r\n            return Vector.size(this);\r\n        },\r\n        normalize: function () {\r\n            return Vector.normalize(this);\r\n        },\r\n        incidence: function (b) {\r\n            return Vector.incidence(this, b);\r\n        },\r\n        cross: function (b) {\r\n            return Vector.cross(this, b);\r\n        },\r\n        towards: function (b, friction) {\r\n            friction = friction || 0.125;\r\n            this.x += (b.x - this.x) * friction;\r\n            this.y += (b.y - this.y) * friction;\r\n            return this;\r\n        },\r\n        add: function (b) {\r\n            this.x += b.x;\r\n            this.y += b.y;\r\n            return this;\r\n        },\r\n        friction: function (b) {\r\n            this.x *= b;\r\n            this.y *= b;\r\n            return this;\r\n        },\r\n        copy: function (b) {\r\n            return new Vector(this.x, this.y);\r\n        },\r\n        toString: function () {\r\n            return '{' + this.x + ',' + this.y + '}';\r\n        },\r\n    };\r\n    return Vector;\r\n});\r\n\r\napp.factory('Utils', ['Vector', function (Vector) {\r\n    (function () {\r\n        var lastTime = 0;\r\n        var vendors = ['ms', 'moz', 'webkit', 'o'];\r\n        for (var x = 0; x < vendors.length && !window.requestAnimationFrame; ++x) {\r\n            window.requestAnimationFrame = window[vendors[x] + 'RequestAnimationFrame'];\r\n            window.cancelAnimationFrame = window[vendors[x] + 'CancelAnimationFrame']\r\n                                       || window[vendors[x] + 'CancelRequestAnimationFrame'];\r\n        }\r\n        if (!window.requestAnimationFrame) {\r\n            window.requestAnimationFrame = function (callback, element) {\r\n                var currTime = new Date().getTime();\r\n                var timeToCall = Math.max(0, 16 - (currTime - lastTime));\r\n                var id = window.setTimeout(function () { callback(currTime + timeToCall); }, timeToCall);\r\n                lastTime = currTime + timeToCall;\r\n                return id;\r\n            };\r\n        }\r\n        if (!window.cancelAnimationFrame) {\r\n            window.cancelAnimationFrame = function (id) {\r\n                clearTimeout(id);\r\n            };\r\n        }\r\n    }());\r\n\r\n    var transformProperty = function detectTransformProperty() {\r\n        var transformProperty = 'transform',\r\n            safariPropertyHack = 'webkitTransform';\r\n\t\tvar div = document.createElement(\"DIV\");\r\n        if (typeof div.style[transformProperty] !== 'undefined') {\r\n            ['webkit', 'moz', 'o', 'ms'].every(function(prefix) {\r\n                var e = '-' + prefix + '-transform';\r\n                if (typeof div.style[e] !== 'undefined') {\r\n                    transformProperty = e;\r\n                    return false;\r\n                }\r\n                return true;\r\n            });\r\n        } else if (typeof div.style[safariPropertyHack] !== 'undefined') {\r\n            transformProperty = '-webkit-transform';\r\n        } else {\r\n            transformProperty = undefined;\r\n        }\r\n        return transformProperty;\r\n    } ();\r\n\r\n    var _isTouch;\r\n    function isTouch() {\r\n        if (!_isTouch) {\r\n            _isTouch = {\r\n                value: ('ontouchstart' in window || 'onmsgesturechange' in window)\r\n            }\r\n        }\r\n        // console.log(_isTouch);\r\n        return _isTouch.value;\r\n    }\r\n\r\n    function getTouch(e, previous) {\r\n        var t = new Vector();\r\n        if (e.type == 'touchstart' || e.type == 'touchmove' || e.type == 'touchend' || e.type == 'touchcancel') {\r\n            var touch = null;\r\n            var event = e.originalEvent ? e.originalEvent : e;\r\n            var touches = event.touches.length ? event.touches : event.changedTouches;\r\n            if (touches && touches.length) {\r\n                touch = touches[0];\r\n            }\r\n            if (touch) {\r\n                t.x = touch.pageX;\r\n                t.y = touch.pageY;\r\n            }\r\n        } else if (e.type == 'click' || e.type == 'mousedown' || e.type == 'mouseup' || e.type == 'mousemove' || e.type == 'mouseover' || e.type == 'mouseout' || e.type == 'mouseenter' || e.type == 'mouseleave') {\r\n            t.x = e.pageX;\r\n            t.y = e.pageY;\r\n        }\r\n        if (previous) {\r\n            t.s = Vector.difference(previous, t);\r\n        }\r\n        t.type = e.type;\r\n        return t;\r\n    }\r\n\r\n    function getRelativeTouch(element, point) {\r\n        var rect = element[0].getBoundingClientRect();\r\n        var e = new Vector(rect.left,  rect.top);\r\n        return Vector.difference(e, point);\r\n    }\r\n\r\n    function getClosest(el, selector) {\r\n        var matchesFn, parent;\r\n        ['matches', 'webkitMatchesSelector', 'mozMatchesSelector', 'msMatchesSelector', 'oMatchesSelector'].some(function (fn) {\r\n            if (typeof document.body[fn] == 'function') {\r\n                matchesFn = fn;\r\n                return true;\r\n            }\r\n            return false;\r\n        });\r\n        while (el !== null) {\r\n            parent = el.parentElement;\r\n            if (parent !== null && parent[matchesFn](selector)) {\r\n                return parent;\r\n            }\r\n            el = parent;\r\n        }\r\n        return null;\r\n    }\r\n\r\n\r\n    var getNow = Date.now || function() {\r\n        return new Date().getTime();\r\n    };\r\n\r\n    function throttle(func, wait, options) {\r\n        // Returns a function, that, when invoked, will only be triggered at most once\r\n        // during a given window of time. Normally, the throttled function will run\r\n        // as much as it can, without ever going more than once per `wait` duration;\r\n        // but if you'd like to disable the execution on the leading edge, pass\r\n        // `{leading: false}`. To disable execution on the trailing edge, ditto.\r\n        var context, args, result;\r\n        var timeout = null;\r\n        var previous = 0;\r\n        if (!options) options = {};\r\n        var later = function () {\r\n            previous = options.leading === false ? 0 : getNow();\r\n            timeout = null;\r\n            result = func.apply(context, args);\r\n            if (!timeout) context = args = null;\r\n        };\r\n        return function () {\r\n            var now = getNow();\r\n            if (!previous && options.leading === false) previous = now;\r\n            var remaining = wait - (now - previous);\r\n            context = this;\r\n            args = arguments;\r\n            if (remaining <= 0 || remaining > wait) {\r\n                if (timeout) {\r\n                    clearTimeout(timeout);\r\n                    timeout = null;\r\n                }\r\n                previous = now;\r\n                result = func.apply(context, args);\r\n                if (!timeout) context = args = null;\r\n            } else if (!timeout && options.trailing !== false) {\r\n                timeout = setTimeout(later, remaining);\r\n            }\r\n            return result;\r\n        };\r\n    }\r\n\r\n    var Style = function() {\r\n        function Style() {\r\n            this.props = {\r\n                scale: 1,\r\n                hoverScale: 1,\r\n                currentScale: 1,\r\n            }\r\n        }\r\n        Style.prototype = {\r\n            set: function (element) {\r\n                var styles = [];\r\n                angular.forEach(this, function (value, key) {\r\n                    if (key !== 'props')\r\n                        styles.push(key + ':' + value);\r\n                });\r\n                element.style.cssText = styles.join(';') + ';';\r\n            },\r\n            transform: function (transform) {\r\n                this[Utils.transformProperty] = transform;\r\n            },\r\n            transformOrigin: function (x, y) {\r\n                this[Utils.transformProperty + '-origin-x'] = (Math.round(x * 1000) / 1000) + '%';\r\n                this[Utils.transformProperty + '-origin-y'] = (Math.round(y * 1000) / 1000) + '%';\r\n            },\r\n        };\r\n        return Style;\r\n    }();\r\n\r\n    function Utils() {\r\n    }\r\n\r\n\tUtils.transformProperty = transformProperty;\r\n    Utils.getTouch = getTouch;\r\n    Utils.getRelativeTouch = getRelativeTouch;\r\n    Utils.getClosest = getClosest;\r\n    Utils.throttle = throttle;\r\n    Utils.Style = Style;\r\n\r\n    return Utils;\r\n}]);\r\n\n/*global angular*/\r\n\r\napp.factory('DataFilter', [function () {\r\n    function DataFilter(data) {\r\n        /*\r\n        this.dateFrom = null;\r\n        this.dateTo = null;\r\n        this.search = null;\r\n        this.status = null;\r\n        */\r\n        data ? angular.extend(this, data) : null;\r\n    }\r\n    DataFilter.prototype = {\r\n        getSearchParams: function (search) {\r\n            var a = [];\r\n            if (search) {\r\n                for (var p in search) {\r\n                    a.push({ name: p, value: search[p] });\r\n                }\r\n            }\r\n            return a;\r\n        },\r\n        getParams: function (source, infinite) {\r\n            var post = {}, value;\r\n            for (var p in this) {\r\n                if (p === 'dateFrom' ||\r\n                    p === 'dateTo' ||\r\n                    p === 'status') {\r\n                    value = this[p];\r\n                    if (value !== undefined) {\r\n                        post[p] = value;\r\n                    }\r\n                } else if (p === 'search') {\r\n                    post[p] = JSON.stringify(this.getSearchParams(this[p]), null, '');\r\n                }\r\n            }\r\n            post.page = source.page;\r\n            post.size = source.size;\r\n            post.infinite = infinite;\r\n            return post;\r\n        },\r\n    };\r\n    return DataFilter;\r\n}]);\r\n\r\napp.factory('DataSource', ['$q', '$http', '$httpAsync', '$timeout', '$rootScope', 'DataFilter', function ($q, $http, $httpAsync, $timeout, $rootScope, DataFilter) {\r\n\r\n    var PAGES_MAX = Number.POSITIVE_INFINITY;\r\n\r\n    function DataSource(data) {\r\n        this.busy = false;\r\n        this.error = false;\r\n        this.size = 10;\r\n        this.maxPages = 10;\r\n        this.rows = [];\r\n        this.filters = {};\r\n        this.service = {\r\n            url: '/api/items/paging',\r\n            resolve: function (items, rows) {\r\n                angular.forEach(items, function (item) {\r\n                    this.push(item);\r\n                }, rows);\r\n            },\r\n        };\r\n        data ? angular.extend(this, data) : null;\r\n        this.filters = new DataFilter(this.filters);\r\n        // FAKE SERVICE FOR TEST !!!\r\n        if (this.service.uri.paging === false) {\r\n            this.get = function (deferred, infinite) {\r\n                this.busy = true;\r\n                this.error = false;\r\n                $timeout(function () {\r\n                    infinite ? null : this.rows.length = 0;\r\n                    this.service.resolve(this.rows);\r\n                    this.page = 1;\r\n                    this.pages = 2;\r\n                    this.count = this.rows.length;\r\n                    this.pagination = this.getPages();\r\n                    this.busy = false;\r\n                    $rootScope.$broadcast('onDataSourceUpdate', this);\r\n                    deferred.resolve(this.rows);\r\n                    // console.log('DataSource.get');\r\n                }.bind(this), 1000);\r\n            };\r\n        }\r\n        this.flush();\r\n    }\r\n    DataSource.prototype = {\r\n        flush: function () {\r\n            this.pages = PAGES_MAX;\r\n            this.page = 1;\r\n            this.count = 0;\r\n            this.opened = null;\r\n        },\r\n        resolve: function (response) {\r\n            var responseHeader = response.headers('X-Pagination');\r\n            var responseView = responseHeader ? JSON.parse(responseHeader) : null;\r\n            // console.log('response', response, 'responseHeader', responseHeader, 'responseView', responseView);\r\n            if (responseView) {\r\n                this.page = responseView.page;\r\n                this.size = responseView.size;\r\n                this.pages = responseView.pages;\r\n                this.count = responseView.count;\r\n            } else {\r\n                this.page = 0;\r\n                this.size = responseView.size;\r\n                this.pages = 0;\r\n                this.count = 0;\r\n            }\r\n            this.pagination = this.getPages();\r\n        },\r\n        get: function (deferred, infinite) {\r\n            this.busy = true;\r\n            this.error = false;\r\n            $httpAsync.get(this.service.uri.paging, { params: this.filters.getParams(this) }).then(function success(response) {\r\n                this.resolve(response);\r\n                infinite ? null : this.rows.length = 0;\r\n                this.service.resolve(response.data, this.rows);\r\n                $rootScope.$broadcast('onDataSourceUpdate', this);\r\n                deferred.resolve(this.rows);\r\n            }.bind(this), function error(response) {\r\n                console.log('error.response', response);\r\n                this.error = true;\r\n                deferred.reject(response);\r\n            }.bind(this))\r\n                .finally(function () {\r\n                    // console.log('DataSource.get');\r\n                    $timeout(function () {\r\n                        this.busy = false;\r\n                    }.bind(this), 1000);\r\n                }.bind(this));\r\n        },\r\n        paging: function () {\r\n            var deferred = $q.defer();\r\n            if (this.busy || this.page > this.pages) {\r\n                deferred.reject();\r\n            } else {\r\n                // console.log('DataSource.paging');\r\n                this.opened = null;\r\n                this.get(deferred);\r\n            }\r\n            return deferred.promise;\r\n        },\r\n        refresh: function () {\r\n            var deferred = $q.defer();\r\n            if (this.busy) {\r\n                deferred.reject();\r\n            } else {\r\n                // console.log('DataSource.refresh');\r\n                this.flush();\r\n                this.get(deferred);\r\n            }\r\n            return deferred.promise;\r\n        },\r\n        more: function () {\r\n            var deferred = $q.defer();\r\n            if (this.busy || this.page + 1 > this.pages) {\r\n                deferred.reject();\r\n            } else {\r\n                // console.log('DataSource.more');\r\n                this.page++;\r\n                this.get(deferred, true);\r\n            }\r\n            return deferred.promise;\r\n        },\r\n        filter: function () {\r\n            this.page = 1;\r\n            this.pages = PAGES_MAX;\r\n            this.paging();\r\n        },\r\n        prevPage: function () {\r\n            var page = this.page - 1;\r\n            if (page > 0 && page <= this.pages) {\r\n                this.page = page;\r\n                this.paging();\r\n            }\r\n        },\r\n        nextPage: function () {\r\n            var page = this.page + 1;\r\n            if (page > 0 && page <= this.pages) {\r\n                this.page = page;\r\n                this.paging();\r\n            }\r\n        },\r\n        gotoPage: function (page) {\r\n            if (page > 0 && page <= this.pages) {\r\n                this.page = page;\r\n                this.paging();\r\n            }\r\n        },\r\n        firstPage: function () {\r\n            if (this.page !== 1) {\r\n                this.page = 1;\r\n                this.paging();\r\n            }\r\n        },\r\n        lastPage: function () {\r\n            if (this.page !== this.pages) {\r\n                this.page = this.pages;\r\n                this.paging();\r\n            }\r\n        },\r\n        hasMany: function () {\r\n            return this.count > 0 && this.pages > this.maxPages;\r\n        },\r\n        hasMorePagesBehind: function () {\r\n            var startingIndex = Math.max(0, this.page - this.maxPages);\r\n            return startingIndex > 0;\r\n        },\r\n        hasMorePagesNext: function () {\r\n            var endingIndex = Math.max(0, this.page - this.maxPages) + this.maxPages;\r\n            return endingIndex < this.pages;\r\n        },\r\n        isPage: function (number) {\r\n            return this.page === number;\r\n        },\r\n        hasPages: function () {\r\n            return this.pages > 0 && this.pages < PAGES_MAX;\r\n        },\r\n        getPages: function () {\r\n            var a = [], i;\r\n            if (this.hasPages()) {\r\n                var startingIndex = Math.max(0, this.page - this.maxPages);\r\n                var endingIndex = Math.min(this.pages, startingIndex + this.maxPages);\r\n                i = startingIndex;\r\n                while (i < endingIndex) {\r\n                    a.push({ number: (i + 1) });\r\n                    i++;\r\n                }\r\n            }\r\n            return a;\r\n        },\r\n        openClose: function (index) {\r\n            if (this.opened === index) {\r\n                this.opened = null;\r\n            } else {\r\n                this.opened = index;\r\n            }\r\n        }\r\n    };\r\n    return DataSource;\r\n}]);\r\n\r\napp.factory('LocalStorage', ['$http', '$q', '$window', function ($http, $q, $window) {\r\n    function LocalStorage() {\r\n    }\r\n\r\n    function isLocalStorageSupported() {\r\n        try {\r\n            return 'localStorage' in window && window['localStorage'] !== null;\r\n        } catch (e) {\r\n            return false;\r\n        }\r\n    }\r\n    LocalStorage.isSupported = isLocalStorageSupported();\r\n    if (!LocalStorage.isSupported) {\r\n        console.log('LocalStorage.unsupported');\r\n    }\r\n\r\n    /** STATIC CLASS METHODS **/\r\n    LocalStorage.set = function (key, data) {\r\n        if (!this.isSupported) {\r\n            return;\r\n        }\r\n        try {\r\n            var cache = [];\r\n            var json = JSON.stringify(data, function (key, value) {\r\n                if (key === 'pool') {\r\n                    return;\r\n                }\r\n                if (typeof value === 'object' && value !== null) {\r\n                    if (cache.indexOf(value) !== -1) {\r\n                        // Circular reference found, discard key\r\n                        return;\r\n                    }\r\n                    cache.push(value);\r\n                }\r\n                return value;\r\n            });\r\n            cache = null;\r\n            $window.localStorage.setItem(key, json);;\r\n        } catch (e) {\r\n            console.log('LocalStorage.set.error serializing', key, data, e);\r\n        }\r\n    };\r\n\r\n    LocalStorage.get = function (key) {\r\n        if (!this.isSupported) {\r\n            return;\r\n        }\r\n        var data = null;\r\n        if ($window.localStorage[key] !== undefined) {\r\n            try {\r\n                data = JSON.parse($window.localStorage[key]);\r\n            } catch (e) {\r\n                console.log('LocalStorage.get.error parsing', key, e);\r\n            }\r\n        }\r\n        return data;\r\n    };\r\n\r\n    // Register on storage event\r\n    LocalStorage.onStorage = function () {\r\n        console.log('LocalStorage.onStorage', arguments);\r\n    };\r\n    angular.element($window).on('storage', LocalStorage.onStorage);\r\n\r\n    return LocalStorage;\r\n}]);\r\n\r\napp.factory('WebWorker', ['$q', '$http', function ($q, $http) {\r\n    var isWebWorkerSupported = (typeof (Worker) !== \"undefined\");\r\n    if (!isWebWorkerSupported) {\r\n        window.Worker = function () {\r\n            function Worker(src) {\r\n                var self = this;\r\n                $http.get(src, { transformResponse: function (d, h) { return d } }).then(function success(response) {\r\n                    try {\r\n                        eval('self.o = function(){ function postMessage(e) { self.onmessage({data:e}); }\\n ' + response.data + ' };');\r\n                        self.object = new self.o();\r\n                        self.object.postMessage = function (e) {\r\n                            self.onmessage({data:e});\r\n                        }\r\n                    } catch(e) {\r\n                        console.log(\"Worker error \", e);\r\n                    }\r\n                }, function error(response) {\r\n                    console.log(\"Worker not found\");\r\n                });\r\n            }\r\n            Worker.prototype = {\r\n                onmessage: function (e) {\r\n                    console.log('Worker not implemented');\r\n                },\r\n                postMessage: function (e) {\r\n                    this.object.onmessage({ data: e });\r\n                }\r\n            }\r\n            return Worker;\r\n        } ();\r\n    }\r\n    function WebWorker(src) {\r\n        var self = this;\r\n        this.callbacks = {};\r\n        this.id = 0;\r\n        this.worker = new Worker(src);\r\n        this.worker.onmessage = function (e) {\r\n            self.onmessage(e);\r\n        };\r\n    }\r\n    WebWorker.prototype = {\r\n        parse: function (e) {\r\n            return JSON.parse(e.data);\r\n        },\r\n        stringify: function (data) {\r\n            return JSON.stringify(data);\r\n        },\r\n        onmessage: function (e) {\r\n            var data = this.parse(e);\r\n            var deferred = this.callbacks[data.id];\r\n            if (data.status !== -1) {\r\n                deferred.resolve(data);\r\n            } else {\r\n                deferred.reject(data);\r\n            }\r\n            delete this.callbacks[data.id];\r\n        },\r\n        post: function (data) {\r\n            var deferred = $q.defer();\r\n            data.id = this.id;\r\n            this.callbacks[this.id.toString()] = deferred;\r\n            this.id++;\r\n            this.worker.postMessage(this.stringify(data));\r\n            return deferred.promise;\r\n        },\r\n    };\r\n    WebWorker.isSupported = isWebWorkerSupported;\r\n    return WebWorker;\r\n}]);\r\n\r\napp.factory('$httpAsync', ['$q', '$http', function ($q, $http) {\r\n    var isWebWorkerSupported = (typeof (Worker) !== \"undefined\");\r\n    if (!isWebWorkerSupported) {\r\n        return $http;\r\n    }\r\n    var worker = new Worker('/js/workers/http.js');\r\n    var callbacks = {};\r\n    var id = 0;\r\n    var lowercase = function (string) { return isString(string) ? string.toLowerCase() : string; };\r\n    var trim = function (value) {\r\n        return isString(value) ? value.trim() : value;\r\n    };\r\n    function $httpAsync(options) {\r\n        var deferred = $q.defer();\r\n        var wrap = getDefaults(options);\r\n        wrap.id = id.toString();\r\n        console.log('wrap', wrap);\r\n        /*\r\n        var xsrfValue = urlIsSameOrigin(config.url)\r\n            ? $$cookieReader()[config.xsrfCookieName || defaults.xsrfCookieName]\r\n            : undefined;\r\n        if (xsrfValue) {\r\n          reqHeaders[(config.xsrfHeaderName || defaults.xsrfHeaderName)] = xsrfValue;\r\n        }\r\n        $httpBackend(config.method, url, reqData, done, reqHeaders, config.timeout,\r\n            config.withCredentials, config.responseType);\r\n        */\r\n        callbacks[wrap.id] = deferred;\r\n        id++;\r\n        worker.postMessage($httpAsync.stringify(wrap));\r\n        return deferred.promise;\r\n    }\r\n    $httpAsync.get = function (url, config) {\r\n        return $httpAsync(angular.extend({}, config || {}, {\r\n            method: 'GET',\r\n            url: url\r\n        }));\r\n    };\r\n    $httpAsync.delete = function (url, config) {\r\n        return $httpAsync(angular.extend({}, config || {}, {\r\n            method: 'DELETE',\r\n            url: url\r\n        }));\r\n    };\r\n    $httpAsync.head = function (url, config) {\r\n        return $httpAsync(angular.extend({}, config || {}, {\r\n            method: 'HEAD',\r\n            url: url\r\n        }));\r\n    };\r\n    $httpAsync.post = function (url, data, config) {\r\n        return $httpAsync(angular.extend({}, config || {}, {\r\n            method: 'POST',\r\n            data: data,\r\n            url: url\r\n        }));\r\n    };\r\n    $httpAsync.put = function (url, data, config) {\r\n        return $httpAsync(angular.extend({}, config || {}, {\r\n            method: 'PUT',\r\n            data: data,\r\n            url: url\r\n        }));\r\n    };\r\n    $httpAsync.patch = function (url, data, config) {\r\n        return $httpAsync(angular.extend({}, config || {}, {\r\n            method: 'PATCH',\r\n            data: data,\r\n            url: url\r\n        }));\r\n    };\r\n    $httpAsync.parse = function (e) {\r\n        return JSON.parse(e.data);\r\n    };\r\n    $httpAsync.stringify = function (data) {\r\n        return JSON.stringify(data);\r\n    };\r\n    $httpAsync.isSupported = isWebWorkerSupported;\r\n    worker.onmessage = function (e) {\r\n        var wrap = $httpAsync.parse(e);\r\n        console.log('onmessage', wrap);\r\n        var deferred = callbacks[wrap.id];\r\n        var status = wrap.status >= -1 ? wrap.status : 0;\r\n        var getter = headersGetter(wrap.response.headers);\r\n        (isSuccess(status) ? deferred.resolve : deferred.reject)({\r\n            data: wrap.response.data, // !!!! JSON.parse(wrap.response.data),\r\n            headers: getter,\r\n            status: wrap.response.status,\r\n            statusText: wrap.response.statusText,\r\n            config: wrap.config,\r\n        });\r\n        delete callbacks[wrap.id];\r\n    }\r\n    return $httpAsync;\r\n    function isSuccess(status) {\r\n        return 200 <= status && status < 300;\r\n    }\r\n    function createMap() {\r\n        return Object.create(null);\r\n    }\r\n    function isString(value) { return typeof value === 'string'; }\r\n    function parseHeaders(headers) {\r\n        var parsed = createMap(), i;\r\n        function fillInParsed(key, val) {\r\n            if (key) {\r\n                parsed[key] = parsed[key] ? parsed[key] + ', ' + val : val;\r\n            }\r\n        }\r\n        if (isString(headers)) {\r\n            var a = headers.split('\\n');\r\n            for (var j = 0; j < a.length; j++) {\r\n                var line = a[j];\r\n                i = line.indexOf(':');\r\n                fillInParsed(lowercase(trim(line.substr(0, i))), trim(line.substr(i + 1)));\r\n            }\r\n        } else if (isObject(headers)) {\r\n            for (var p in headers) {\r\n                fillInParsed(lowercase(p), trim(headers[p]));\r\n            }\r\n        }\r\n        return parsed;\r\n    }\r\n    function headersGetter(headers) {\r\n        var headersObj;\r\n        return function (name) {\r\n            if (!headersObj) headersObj = parseHeaders(headers);\r\n            if (name) {\r\n                var value = headersObj[lowercase(name)];\r\n                if (value === void 0) {\r\n                    value = null;\r\n                }\r\n                return value;\r\n            }\r\n            return headersObj;\r\n        };\r\n    }\r\n    function getDefaults(options) {\r\n        var defaults = {\r\n            method: 'GET',\r\n            withCredentials: false,\r\n            responseType: 'json',\r\n            headers: {},\r\n            config: {}\r\n        }\r\n        defaults.withCredentials = $http.defaults.withCredentials;\r\n        angular.extend(defaults.headers, $http.defaults.headers.common);\r\n        var method = (options.method || defaults.method).toLowerCase();\r\n        if ($http.defaults.headers[method]) {\r\n            angular.extend(defaults.headers, $http.defaults.headers[method]);\r\n        }\r\n        console.log('defaults', $http.defaults);\r\n        // defaults = angular.extend(defaults, $http.defaults);\r\n        /*\r\n    method{string}:                     HTTP method (e.g. 'GET', 'POST', etc)\r\n    url:{string}:                       Absolute or relative URL of the resource that is being requested.\r\n    params:{Object.<string|Object>}:    Map of strings or objects which will be serialized with the paramSerializer and appended as GET parameters.\r\n\r\n    data:{string|Object}:               Data to be sent as the request message data.\r\n    headers:{Object}:                   Map of strings or functions which return strings representing HTTP headers to send to the server. If the return value of a function is null, the header will not be sent. Functions accept a config object as an argument.\r\n\r\n    xsrfHeaderName:{string}:            Name of HTTP header to populate with the XSRF token.\r\n    xsrfCookieName:{string}:            Name of cookie containing the XSRF token.\r\n    transformRequest:{function(data, headersGetter)|Array.<function(data, headersGetter)>}:         transform function or an array of such functions. The transform function takes the http request body and headers and returns its transformed (typically serialized) version. See Overriding the Default Transformations\r\n\r\n    transformResponse:{function(data, headersGetter, status)|Array.<function(data, headersGetter, status)>}:    transform function or an array of such functions. The transform function takes the http response body, headers and status and returns its transformed (typically deserialized) version. See Overriding the Default TransformationjqLiks\r\n\r\n    paramSerializer:{string|function(Object<string,string>):string}:        A function used to prepare the string representation of request parameters (specified as an object). If specified as string, it is interpreted as function registered with the $injector, which means you can create your own serializer by registering it as a service. The default serializer is the $httpParamSerializer; alternatively, you can use the $httpParamSerializerJQLike\r\n\r\n    cache:{boolean|Cache}:              If true, a default $http cache will be used to cache the GET request, otherwise if a cache instance built with $cacheFactory, this cache will be used for caching.\r\n\r\n    timeout:{number|Promise}:           timeout in milliseconds, or promise that should abort the request when resolved.\r\n    withCredentials:{boolean}:          whether to set the withCredentials flag on the XHR object. See requests with credentials for more information.\r\n\r\n    responseType:{string}:              see XMLHttpRequest.responseType.\r\n        */\r\n        options ? options = angular.extend(defaults, options) : defaults;\r\n        return options;\r\n    }\r\n}]);\r\n\n/*global angular*/\r\n\r\napp.controller('TestCtrl', ['$scope', '$location', '$timeout', 'DataSource', 'DishesTest', function ($scope, $location, $timeout, DataSource, DishesTest) {\r\n\r\n    $scope.filters = {\r\n        search: {\r\n        }\r\n    };\r\n\r\n    $scope.source = new DataSource({\r\n        service: DishesTest,\r\n        filters: $scope.filters\r\n    });\r\n\r\n    $timeout(function() {\r\n        $scope.source.paging();\r\n    }, 1000);\r\n\r\n}]);\r\n"],"sourceRoot":"/source/"}